#!/usr/bin/perl

use strict;
use Getopt::Long;

my ($siteSet, $build);

&GetOptions('siteSet=s' => \$siteSet,
	    'build=s' => \$build,
	   );

usage() if $siteSet ne "q" && $siteSet ne "w";
usage() if !$build;

my @componentList = ` find /var/www  -maxdepth 1 -type d -name '*DB' -printf "%f\n"|grep -v ApiDB`;
my @campusList = (1, 2);

foreach my $campus (@campusList) {
  foreach my $component (@componentList) {
    chomp($component);
    my $lcComponent = lc($component);
    my $site = "$siteSet$campus.$lcComponent.org";
    print "$site /usr/local/tomcat_instances/$component/logs/*.b$build/wdk.log4j* /var/log/httpd/$site/access_log\n";

  }
}

sub usage {
  print STDERR "

Generate the space-delimited input file that wdkSlowQueryReport reads from its standard in to specify what log files to report on. It can be used in a command pipeline with wdkSlowQueryReport.

usage:  wdkSlowQueryReportInput -siteSet [ q | w ] -build <build>

where:
  [q | w] determines whether to specify a report on [w]ww or [q]a sites, and
  <build> is the build number (e.g. \"-build 12\")

example pipelines:
wdkSlowQueryReportInput -siteSet w -build 11 | wdkSlowQueryReport -s 0.01 -i
wdkSlowQueryReportInput -siteSet w -build 11 | grep -i crypto | wdkSlowQueryReport -s 0.01 -t 1309276800 -i
wdkSlowQueryReportInput -siteSet w -build 12 | grep -vi EuPathDB | wdkSlowQueryReport -s 0.01 -t 1309276800 -i
wdkSlowQueryReportInput -siteSet q -build 13 | grep q2 | wdkSlowQueryReport -s 0.01 -t 1309276800 -i
";
  exit(1);
}
